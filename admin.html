<!DOCTYPE html>
<html>
<head>
<title>Applyze Applicants Dashboard</title>

<style>
body{
  font-family:Poppins,system-ui;
  margin:0;
  padding:0;
  color:white;
  overflow-x:hidden;
}

/* VIDEO BACKGROUND */
.video-bg{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100vh;
  object-fit:cover;
  z-index:-2;
}

/* LOWER RIGHT LOGIN PANEL */
.top-right-panel{
  position:absolute;
  bottom:20px;
  right:20px;
  display:flex;
  flex-direction:column;
  align-items:flex-end;
  gap:10px;
  text-align:right;
}

h2{
  margin:0;
  font-size:22px;
  font-weight:600;
}

/* LOGIN INPUT + BUTTON */
.login-row{
  display:flex;
  gap:6px;
  align-items:center;
}

input{
  padding:10px 34px 10px 10px;
  width:220px;
  border-radius:6px;
  border:0;
  position:relative;
}

button{
  padding:10px 14px;
  background:#0c4bfa;
  color:white;
  border:0;
  border-radius:6px;
  cursor:pointer;
  font-size:14px;
}

/* EYE ICON */
.eye{
  position:relative;
  right:32px;
  cursor:pointer;
  font-size:14px;
  color:black;
}

/* TABLE SECTION */
#data{
  margin:40px 20px 20px 20px;
}

table{
  width:100%;
  border-collapse:collapse;
  background:rgba(255,255,255,0.08);
  color:white;
}

td,th{
  padding:12px;
  border-bottom:1px solid rgba(255,255,255,0.30);
}

th{
  background:rgba(255,255,255,0.20);
  font-weight:600;
}

select{
  padding:6px 10px;
  background:#0c4bfa;
  color:white;
  border:0;
  border-radius:6px;
}

</style>
</head>

<body>

<!-- BACKGROUND VIDEO -->
<video autoplay muted loop playsinline class="video-bg">
  <source src="INNOV2.mp4" type="video/mp4">
</video>

<!-- DASHBOARD TITLE + LOGIN PANEL -->
<div class="top-right-panel">
  <h2>Applyze Applicants Dashboard</h2>

  <div class="login-row">
    <input type="password" id="pw" placeholder="Enter password">
    <span class="eye" onclick="togglePW()">üëÅ</span>
    <button onclick="unlock()">Login</button>
  </div>
</div>

<!-- DATA TABLE -->
<div id="data" style="display:none">
  <table id="table"></table>
</div>

<script>
const PASS = "admin123";
const URL = "https://script.google.com/macros/s/AKfycbzD7fzvV7g8CrTvy_dupO9qOQCIsjpYhUP98rUpLE-8ySWulAwUdWdEbrPyz0ELp_3GmQ/exec";

// PASSWORD REVEAL
function togglePW(){
  const pwField = document.getElementById('pw');
  pwField.type = pwField.type === "password" ? "text" : "password";
}

// LOGIN
function unlock(){
  const pw = document.getElementById('pw').value.trim();
  if(pw !== PASS){
    alert("Incorrect password");
    return;
  }
  document.getElementById('data').style.display = "block";
  load();
}

// LOAD SHEET RECORDS
async function load(){

  let res;
  try {
    res = await fetch(URL + "?nocache=" + Date.now());
  } catch(e){
    alert("Connection failed. Check Apps Script permissions.");
    return;
  }

  let json;
  try {
    json = await res.json();
  } catch(e){
    alert("No data found in sheet.");
    return;
  }

  if(!json || json.length === 0){
    alert("Sheet is empty or unreachable.");
    return;
  }

  let html = `
  <tr>
    <th>Name</th>
    <th>Email</th>
    <th>Contact</th>
    <th>Education</th>
    <th>HR Exp</th>
    <th>Admin Exp</th>
    <th>Skills Relevant</th>
    <th>Date</th>
    <th>Time</th>
    <th>Qualified For</th>
    <th>Status</th>
    <th>Interview Result</th>
  </tr>`;

  json.forEach(r=>{
    html += `
    <tr>
      <td>${r.name}</td>
      <td>${r.email}</td>
      <td>${r.contact}</td>
      <td>${r.education}</td>
      <td>${r.hrExp}</td>
      <td>${r.adminExp}</td>
      <td>${r.skillsRelevant}</td>
      <td>${r.date}</td>
      <td>${r.time}</td>
      <td>${r.target}</td>
      <td>${r.status}</td>
      <td>
        <select onchange="saveResult('${r.row}', this.value)">
          <option value="" ${r.result===""?"selected":""}>Select</option>
          <option ${r.result==="Passed"?"selected":""}>Passed</option>
          <option ${r.result==="Failed"?"selected":""}>Failed</option>
        </select>
      </td>
    </tr>`;
  });

  document.getElementById("table").innerHTML = html;
}

// SAVE INTERVIEW RESULT
async function saveResult(row,value){
  await fetch(URL + "?update=1&row=" + row + "&result=" + value);
  alert("Saved!");
}
</script>

</body>
</html>
